<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Soroban Canvas Quiz</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      width: 100vw; height: 100vh; overflow: hidden;
      background: #b3c4e7;
      font-family: sans-serif;
    }
    #abacusRoot {
      position: absolute;
      top: 0; right: 0;
      width: 100vw; height: 100vh;
      display: flex;
      justify-content: flex-end;
      align-items: center;
      background: #4d79ff;
      overflow: hidden;
      z-index: 1;
    }
    .soroban {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 5px;
      width: 160%;
      height: 100%;
    }
    .rod {
      position: relative; width: 95px; height: 390px;
      background: #4d79ff;
      border-radius: 5px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
    }
    .rod-line {
      position: absolute; top: 0; bottom: 0; width: 3px;
      background: #6666ff; z-index: 0;
    }
    .heaven {
      display: flex; flex-direction: column; justify-content: flex-end; align-items: center;
      height: 14%; gap: 2px; z-index: 1;
    }
    .gap-space { height: 2%; z-index: 1; }
    .earth {
      display: flex; flex-direction: column; justify-content: flex-start; align-items: center;
      height: 53%; margin-top: 3px; z-index: 1; gap: 3px;
    }
    .bar {
      position: absolute; top: 27%; width: 100%; height: 3px;
      background: #6666ff; z-index: 2;
    }
    .bead {
      width: 90px; height: 50px; margin: 0;
      background: linear-gradient(to bottom, #002db3, #002080);
      clip-path: polygon(25% 0%,75% 0%,100% 50%,75% 100%,25% 100%,0% 50%);
      box-shadow: inset -1px -1px 4px rgba(255,255,255,0.3), inset 1px 1px 4px rgba(0,0,0,0.3);
      transition: transform 0.2s; touch-action: none; z-index: 3;
    }
    .bead.active {
      background: radial-gradient(circle at 30% 30%, #ffd700, #ffa500);
      box-shadow: inset -2px -2px 5px rgba(255,255,255,0.4), inset 2px 2px 5px rgba(0,0,0,0.3);
    }
    .bead.heaven.active { transform: translateY(100%); }
    .bead.earth.active { transform: translateY(-150%); }

    #quizPanel {
      position: absolute;
      top: 0; left: 0;
      width: clamp(240px, 20vw, 360px);
      height: 100vh;
      background: rgba(140,166,219,0.95);
      color: #fff;
      z-index: 2;
      display: flex;
      flex-direction: column;
      padding: 1rem;
      overflow-y: auto;
    }
    #topBtns {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }
    #fullscreenBtn, #resetBtn {
      background: transparent;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #fff;
    }
    #quizContent {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .question { display: flex; align-items: center; gap: 0.5rem; }
    #qNum {
      background: #668cff;
      padding: 0.3rem 0.8rem;
      border-radius: 0.3rem;
      font-weight: bold;
    }
    #qText {
      flex: 1;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
    }
    .input-label { font-weight: bold; }
    .inputArea { display: flex; gap: 0.5rem; align-items: center; }
    #answerDisplay {
      flex: 1;
      background: #fff;
      color: #333;
      text-align: right;
      padding: 0.5rem;
      border: 2px solid #b993d6;
      border-radius: 0.4rem;
      font-size: 1.2rem;
      cursor: pointer;
    }
    #sendBtn {
      background: #668cff;
      border: none;
      color: #fff;
      padding: 0.5rem 1rem;
      border-radius: 0.4rem;
      cursor: pointer;
      font-size: 1rem;
    }
    #numpad {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.5rem;
    }
    #numpad button {
      background: #668cff;
      border: none;
      color: #fff;
      padding: 0.6rem;
      border-radius: 0.4rem;
      font-size: 1.2rem;
      cursor: pointer;
    }
    #quizTimer {
      text-align: center;
      font-weight: bold;
      margin-top: auto;
    }
    #resultsSlide {
      position: absolute;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: rgba(255,255,255,0.95);
      z-index: 9999;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      box-sizing: border-box;
      text-align: center;
    }
    .result-item {
      font-size: 1.1rem;
      margin: 0.25rem 0;
    }
    .result-score {
      margin: 1rem 0;
      font-size: 1.3rem;
      font-weight: bold;
    }
    .result-btn {
      background: #668cff;
      color: #fff;
      border: none;
      padding: 0.6rem 1.2rem;
      border-radius: 0.4rem;
      font-size: 1rem;
      margin: 0.5rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- existing content remains the same -->
  <div id="resultsSlide">
    <h2>Results</h2>
    <div id="resultList"></div>
    <div class="result-score" id="resultScore"></div>
    <button class="result-btn" onclick="location.reload()">‚Ü∫ Try Again</button>
    <button class="result-btn" id="fullscreenToggle">‚õ∂</button>
  </div>
  <script>
    const resultsSlide = document.getElementById("resultsSlide");
    const resultList = document.getElementById("resultList");
    const resultScore = document.getElementById("resultScore");
    const fullscreenToggle = document.getElementById("fullscreenToggle");

    fullscreenToggle.addEventListener("click", () => {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
        fullscreenToggle.textContent = '‚õ∂';
      } else {
        document.exitFullscreen();
        fullscreenToggle.textContent = 'ü°Ω';
      }
    });

    function showResults() {
      let correct = 0;
      resultList.innerHTML = '';
      answers.forEach((a, i) => {
        const isCorrect = a.user === a.correct;
        const div = document.createElement('div');
        div.className = 'result-item';
        div.innerHTML = `Q${i + 1}: ${a.user} ${isCorrect ? '‚úîÔ∏è' : '‚ùå'}<br><small>Correct: ${a.correct}</small>`;
        if (isCorrect) correct++;
        resultList.appendChild(div);
      });
      resultScore.textContent = `You scored ${correct} / ${answers.length}`;
      resultsSlide.style.display = 'flex';
    }
  </script>
</body>
</html>
